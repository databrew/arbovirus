
caption <- "Capacity for virological surveillance on human specimens (ref Q19)"
responses <- get_responses("19")
idx <- grep("Comment", colnames(responses))
responses <- responses[,-idx]
responses <- responses %>%
  mutate_at( .vars=vars(colnames(responses)),
             .funs = forcats::fct_recode,
             "X"="Yes",
             " "="Not selected") 

colnames(responses) <- c("Virus isolation",
                         "RT-PCR",
                         "Other nucleic acid tests",
                         "Serological testing",
                         "None",
                         "I don't know") 
empty_cols = c()
for(i in 1:ncol(responses)){
  responses[,i] <- as.character( responses[,i] )
  responses[ which( is.na( responses[,i])) ,i] <- " "
  if( all(responses[,i] != "X" )){
    empty_cols = c(empty_cols, colnames(responses)[i])
  }
}

cbind(Country=data$SI01, responses) %>%
  select( -empty_cols ) %>%
  regulartable() %>%
  set_caption( caption ) %>% autofit()

 
