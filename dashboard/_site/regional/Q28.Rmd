
#### Entomologic surveillance conducted for arboviral infections in mosquito vectors in the past two years (ref Q28)

```{r}
responses <- get_responses("28")
responses <- cbind(Country = data$SI01, responses)
conducted <- responses$Country[which(responses$Response == "Yes")]
not_conducted <- responses$Country[which(responses$Response == "No")]
no_response <- responses$Country[which(is.na(responses$Response))]

```

Countries that conducted entomologic surveillance included `r conducted`. Countries that did not included
`r not_conducted`. `r no_response` did not respond. 

<br>
 
#### Frequency and scope of entomologic surveillance (ref Q28c, 28d, 28e)

```{r}
q28e <- get_responses("28e")
colnames( q28e ) <- c("How_often", "Other")
q28e <- q28e %>%
  mutate( How_often = factor( replace_na( as.character(How_often), ""))) %>%
  mutate( Other = factor( replace_na( as.character(Other), ""))) %>%
  unite( Response, How_often:Other, sep="") 
q28e <- cbind( Country = data$SI01, q28e)

q28c <- get_responses("28c")
colnames( q28c ) <- c("Scope", "Comments")
q28c <- q28c %>%
  mutate( Scope = recode_factor(.x = Scope,
                                   "Country wide"="Country wide",
                                   "Restricted to specific locations . Please specify where:"="Restricted to specific locations",
                                   "Don’t know"="I don’t know"))
responses <- cbind( q28e, q28c)

q28d <- get_responses("28d")
q28d <- cbind( Country = data$SI01, q28d) %>% 
  drop_na(Response) %>%
  mutate( Response = paste0("(", Response, " sentinel sites)")) %>%
  rename( "Sites" = Response )

left_join( responses, q28d, by="Country") %>%
  mutate( Scope = as.character( Scope ) ) %>%
  replace_na( list( Scope = "", Sites = "")) %>%
  unite( "Geographic scope", c("Scope", "Sites"), sep = "\n") %>%
  regulartable( ) %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>

### Performance of adult and larval/pupal mosquito surveillance

<br>

#### Mosquito surveillance and identification (ref Q29, 30, 31)

```{r}
q29 <- get_responses("29")
q29 <- q29 %>% 
  mutate( Response = recode_factor(.x=Response,
                                   "Yes"="X",
                                   "No"=" ")) %>%
  rename("Adult surveillance"="Response") 
q30 <- get_responses("30")
q30 <- q30 %>% 
  mutate( Response = recode_factor(.x=Response,
                                   "Yes"="X",
                                   "No"=" ")) %>%
  rename("Larval/pupal surveillance"="Response")
q31 <- get_responses("31")
q31 <- q31 %>% 
  mutate( Response = recode_factor(.x=Response,
                                   "Yes"="X",
                                   "No"=" ")) %>%
  rename("Trapped mosquitoes identified to species"="Response")
cbind(Country=data$SI01, q29, q30, q31) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>
 
#### Minimum infection rate (MIR) calculations for any _Aedes_-borne arboviruses (ref Q32)

```{r}
responses <- get_responses("32")
colnames( responses ) <- c("Response", "Comments")
cbind(Country=data$SI01, responses) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br> 

#### Laboratories testing mosquito pools for arboviruses (ref Q33)

```{r}
responses <- get_responses("33") 
# other <- responses %>% select(Other)
# responses <- responses %>% select(-Other)

responses <- responses %>%
  mutate_at( .vars=vars(colnames(responses)),
             .funs = forcats::fct_recode,
             "X" = "Yes",
             " " = "Not selected") 

empty_cols = c()
for(i in 1:ncol(responses)){
  responses[,i] <- as.character( responses[,i] )
  responses[ which( is.na( responses[,i])) ,i] <- " "
  if( all(responses[,i] != "X" )){
    empty_cols = c(empty_cols, colnames(responses)[i])
  }
}

cbind(Country=data$SI01, responses) %>%
  select(-empty_cols) %>% 
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```
