
### Presence of a community outreach program that also covers arboviral diseases

#### Community outreach program presence, leadership, and geographic scope (ref Q43, 43b, 43c)

```{r}
q43 <- get_responses("43") %>%
  rename( "In place" = Response)

q43b <- get_responses("43b") %>%
  rename( "Entity in charge" = Response)

q43c <- get_responses("43c") 
colnames( q43c ) <- c("Response","Areas") 
q43c <- q43c %>% 
  mutate( across( everything(), as.character)) %>%
  mutate( across( everything(), replace_na, "") )
q43c$Response[ grep("Only selected areas", q43c$Response ) ] <- "Only selected areas"
q43c <- q43c %>%
  unite( Scope, Response:Areas, sep="\n")

cbind(Country=data$SI01, q43, q43b, q43c) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>

#### Is the community outreach/social mobilization program sufficiently funded to cover staff time, prevention and outreach activities as needed? (ref Q43d)

```{r}
responses <- get_responses("43d")
cbind(Country=data$SI01, responses) %>%
  regulartable() %>%
  # hline( part="all") %>% autofit()
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>

#### Resources needed to ensure adequate community outreach capacity (ref Q43e)

```{r}
responses <- get_responses("43e")
other <- responses %>% select(Other)
responses <- responses %>% select(-Other)

responses <- responses %>%
  mutate( across(everything(), na_if, "Not selected") ) %>%
  mutate( across(everything(), as.character)) %>%
  mutate( across(everything(), str_replace, pattern="Yes", replacement="X"))

keep_cols = c()
for(i in 1:ncol(responses)){
  if( any( !is.na(responses[,i]) )){
    keep_cols = c(keep_cols, colnames(responses)[i])
  }
}

if( any(!is.na(other$Other))){
  responses <- cbind( responses, other)
  keep_cols <- c( keep_cols, "Other")
}

cbind(Country=data$SI01, responses) %>%
  select( c("Country", keep_cols )) %>%
  filter( if_any(keep_cols, ~ !is.na(.) ) ) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>

#### Regular training sessions for staff in charge of community sensitization, mobilisation and acceptance of interventions dedicated to control arboviral diseases (ref Q45)

```{r}
responses <- get_responses("45")
colnames( responses ) <- c("Response", "Comments")
cbind(Country=data$SI01, responses) %>%
  # mutate( Response = factor( replace_na( as.character(Response), "Unanswered"))) %>%
  mutate( Response = recode_factor(.x = Response,
                                   "Yes. If yes, please describe in comments field:"="Yes",
                                   "No"="No",
                                   "I don’t know"="I don’t know")) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```
