
### Vector control methods

#### Vector control methods used in local jurisdictions in the past two years (either using government staff and resources, or subcontracting to a different entity to do so) (ref Q35)

```{r}
responses <- get_responses("35")
other <- responses %>% select(Other)
responses <- responses %>% select(-Other)

responses <- responses %>%
  mutate_at( .vars=vars(colnames(responses)),
             .funs = forcats::fct_recode,
             "X" = "Yes",
             " " = "Not selected") %>%
  rename("Adulticiding"="Adulticiding (insecticide application against adult mosquitoes)")

# empty_cols = c()
# for(i in 1:ncol(responses)){
#   responses[,i] <- as.character( responses[,i] )
#   responses[ which( is.na( responses[,i])) ,i] <- " "
#   if( all(responses[,i] == " " )){
#     empty_cols = c(empty_cols, colnames(responses)[i])
#   }
# }

if( any(!is.na(other$Other))){
  responses <- cbind( responses, other)
}

cbind(Country=data$SI01, responses) %>%
  # select(-empty_cols) %>%
  regulartable() %>%
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()

# empty_cols <- empty_cols[ which(empty_cols != "None")]

# Fix and add back in!!
# No countries reported the use of `r (empty_cols)`.

```

<br>

#### Adulticides and/or larvicides (brand and product name) used (ref Q35c)

```{r}
responses <- get_responses("35c")
cbind(Country=data$SI01, responses) %>%
  drop_na( Response ) %>%
  rename("Product used"=Response) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```

<br>

#### Surveillance system in place for monitoring _Aedes_ resistance to the insecticide(s) used (ref Q39)

```{r}
responses <- get_responses("39")
responses <- cbind(Country=data$SI01, responses) 
monitoring <- responses$Country[ which(responses$Response == "Yes")]
```

`r monitoring` indicated that there is _Aedes_ resistance monitoring in place. 

<br> 

#### Staff training in vector control and surveillance (ref Q36)

```{r}
responses <- get_responses("36")
cbind(Country=data$SI01, responses) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  autofit()
```
