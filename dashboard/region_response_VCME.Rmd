---
title: "Regional data (Vector control method employed)"
---

```{r, include=FALSE, echo = FALSE}
# Basic knitr options
library(knitr)
opts_chunk$set(comment = NA, 
               echo = FALSE,
               warning = FALSE, 
               message = FALSE, 
               error = TRUE, 
               cache = FALSE,
               fig.width = 9.64,
               fig.height = 5.9,
               fig.path = 'figures/')
ggplot2::theme_set(ggplot2::theme_bw())

# options(scipen = '999')
```

```{js}
element = document.getElementById('WHO_logo');
console.log(element)

$('#WHO_logo').click(function(e){
    console.log("Exists!")
});


window.onscroll = function() { scrollFunction() };

var navbar = document.getElementById("navbar");
var logoWhiteElement = document.getElementById("whiteLogoPosition")
var sticky = navbar.offsetTop;

function scrollFunction() {
  if (window.pageYOffset >= sticky) {
    navbar.classList.add("sticky");
    logoWhiteElement.classList.add("white_logo_appear");
  } else {
    navbar.classList.remove("sticky");
    logoWhiteElement.classList.remove("white_logo_appear");
  }
}

$(document).on('click', function (e){
    /* Global data  */
    var global_menu_opened = $('#global-navigation').hasClass('in');
    if(!$(e.target).closest('#global-navigation').length &&
        !$(e.target).is('#global-navigation') &&
        global_menu_opened === true){
            $('#global-navigation').collapse('toggle');
            $( "#Global-Li-area" ).removeClass("activeMenuState");
    }
    
    if ($('#global-navigation').attr('aria-expanded') === "false") {
      $( "#Global-Li-area" ).removeClass("activeMenuState");
    }
    if ($('#global-navigation').attr('aria-expanded') === "true") {
      $( "#Global-Li-area" ).addClass("activeMenuState");
    }

     /* Regional data  */
    var regional_menu_opened = $('#regional-navigation').hasClass('in');
    if(!$(e.target).closest('#regional-navigation').length &&
        !$(e.target).is('#regional-navigation') &&
        regional_menu_opened === true){
            $('#regional-navigation').collapse('toggle');
            $( "#Regional-Li-area" ).removeClass("activeMenuState");
    }
    
    if ($('#regional-navigation').attr('aria-expanded') === "false") {
      $( "#Regional-Li-area" ).removeClass("activeMenuState");
    }
    if ($('#regional-navigation').attr('aria-expanded') === "true") {
      $( "#Regional-Li-area" ).addClass("activeMenuState");
    }
     
     
     /* Country data  */
    var country_menu_opened = $('#country-navigation').hasClass('in');
    if(!$(e.target).closest('#country-navigation').length &&
        !$(e.target).is('#country-navigation') &&
        country_menu_opened === true){
            $('#country-navigation').collapse('toggle');
            $( "#Country-Li-area" ).removeClass("activeMenuState");
    }
    
    if ($('#country-navigation').attr('aria-expanded') === "false") {
      $( "#Country-Li-area" ).removeClass("activeMenuState");
    }
    if ($('#country-navigation').attr('aria-expanded') === "true") {
      $( "#Country-Li-area" ).addClass("activeMenuState");
    }


});

```


```{r, child="_sessioninfo.Rmd"}
```

```{r, echo = FALSE}
source('functions.R')
dict <- load_dict()
df <- load_data()
```

# Surveillance capacity indicators

### Reportable arboviral diseases

#### Is reporting mandatory for any arboviral disease cases in your country? (Question 11) 

```{r}

# relevant question: q11

responses <- get_responses("11")
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally 
tab <- qdf %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals() 
regulartable( tab ) %>%
  colformat_num( na_str = "0" ) %>%
  hline(i=4) %>%
  autofit 

ggplot( qdf, 
        aes( x = Response,
             y = n,
             fill = Response)) +
  geom_col() +
  facet_wrap( ~Region ) +
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill=guide_legend(ncol=3)) +
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Response)))) +
  labs(title = "Mandatory reporting of cases", 
       y = 'Responses')
  

```

#### For which of the following arboviral disease cases is reporting mandatory in your country? (Question 11b) 

```{r}

# relevant question: q11b

responses <- get_responses("11b")
qdf <- cbind(Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Arbovirus", values_to="Response") %>% 
  group_by(Region, Arbovirus, Response) %>% 
  tally
qdf$Response <- str_to_sentence(gsub("Mandatory reporting of ", "", qdf$Response))
tab <- qdf %>% 
  pivot_wider(names_from=Response, values_from=n) %>% 
  drop_na(Region) %>% 
  relocate("Confirmed cases only", .after="All suspect cases") %>%
  rename("No answer"='NA')
tab %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=6*(1:4)) %>% 
  colformat_num(na_str = "0") %>%
  fix_border_issues() %>%
  width( j=2, width=2 )
  # autofit() 

ggplot(qdf, aes(x=Response, y=n, fill=Response)) + 
  geom_col() + 
  facet_grid( Region ~ Arbovirus ) +
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill=guide_legend(ncol=4)) +
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Response)))) +
  labs(title = "Regional reporting of cases", 
       y = 'Responses')

```

### History of any arbovirus circulation since 2000 

#### Which arboviruses have circulated in your country at any time since the year 2000?  This refers only to arboviruses with autochthonous i.e., local mosquito-borne transmission. (Question 5) 

```{r}

# relevant question: q5

responses <- get_responses("5")
other <- responses %>% select(Other)
responses <- responses %>% select(-Other)
qdf <- cbind( Region = df$Region, responses) %>% 
  drop_na(Region) %>% 
  pivot_longer(!Region, names_to="Arbovirus", values_to="Response") %>% 
  group_by(Region, Arbovirus, Response) %>% 
  tally
qdf %>% 
  pivot_wider( names_from=Response, values_from=n) %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=4*(1:4)) %>% 
  colformat_num( na_str = "0" ) %>%
  fix_border_issues %>%
  autofit 

# qdf <- responses %>%
#   pivot_longer(cols = colnames(responses), names_to="Arbovirus", values_to="Response") %>% 
#   group_by(Arbovirus, Response) %>% 
#   tally
# 

ggplot(data = qdf %>% filter(Response == 'Yes'),
       aes(x = Arbovirus,
           y = n,
           fill = Arbovirus)) +
  geom_col() +
  facet_grid( ~Region ) +
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill=guide_legend(ncol=4)) +
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Arbovirus)))) +
  labs(title = "Arbovirus circulation since 2000", 
       y = 'Responses')

```


### Conducting surveillance on humans

#### In the last 2 years, did your country conduct national epidemiological surveillance for human cases of arboviral disease? (Question 12) 

```{r}

# relevant question: q12 (surveillance on humans)

responses <- get_responses("12")
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals()
regulartable( qdf ) %>%
  colformat_num( na_str="0" ) %>%
  hline(i=4) %>%
  autofit 

```


### Conducting surveillance on vectors 

#### For the last 2 years, did your country conduct entomologic surveillance for arboviral infections in mosquito vectors? (Question 28) 

```{r}
# relevant question: q28 (surveillance on vectors)

responses <- get_responses("28")
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals()
regulartable( qdf ) %>%
  colformat_num( na_str="0" ) %>%
  hline(i=4) %>% 
  autofit 

```


### Conducting surveillance on animals 

#### During the last 2 years, did your country conduct national epidemiological surveillance for arboviral disease in animals (e.g., epizootic surveillance for yellow fever in endemic areas)? (Question 41) 

```{r}

# relevant question: q41 (surveillance on animals)

responses <- get_responses("41")
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals()
regulartable( qdf ) %>%
  colformat_num( na_str="0" ) %>%
  hline(i=4) %>% 
  autofit 

```

### Training of surveillance personnel and clinicians

#### Which training has been provided to the staff working on arboviral disease surveillance data? (Question 10) 

```{r}

# relevant question: q10 

responses <- get_responses("10")
other <- responses %>% select(Other)
responses <- responses %>% select(-Other)
qdf <- cbind( Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Training", values_to="Response") %>% 
  group_by(Region, Training, Response) %>% 
  tally
qdf %>% 
  pivot_wider( names_from=Response, values_from=n) %>% 
  drop_na(Region) %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=5*(1:4)) %>% 
  colformat_num( na_str = "0" ) %>%
  fix_border_issues %>%
  width( j=2, width=3 ) %>%
  autofit 

```


#### Does your country provide regular training sessions for healthcare workers on clinical diagnosis and management of Aedes-borne arboviral diseases? (Question 24) 

```{r}
# relevant question: q24

responses <- get_responses("24")
colnames(responses) <- c("Response", "Comments")
comments <- responses %>% select(Comments)
responses <- responses %>% select(Response)
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals() 
colnames(qdf)[2] <- "Yes"
regulartable( qdf ) %>%
  colformat_num( na_str="0" ) %>% 
  hline(i=4) %>%
  autofit 

```

### Presence written arbovirus surveillance and control plans

#### Do you have any written arbovirus surveillance and control plan(s) and/or guideline(s) for your country? (Question 6) 

```{r}

# relevant question: q6

responses <- get_responses("6")

qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals()
regulartable( qdf ) %>%
  colformat_num( na_str="0" ) %>%
  hline(i=4) %>% 
  # width( j=2:3, width=1.5 ) %>%
  autofit 

```

### Arbovirus program independent or integrated

(q7)

### Tools for case reporting 

(q9)

# Laboratory diagnostic indicators


### Testing in outbreak vs non-outbreak settings 

#### Is arbovirus diagnostic laboratory testing performed for confirmation of suspected cases in your country? (Please select the applicable option during outbreak periods and during non-outbreak periods, respectively) (Question 15) 

```{r}

# relevant question: q15

responses <- get_responses("15")

qdf <- cbind( Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Training", values_to="Response") %>% 
  group_by(Region, Training, Response) %>% 
  tally 
qdf %>% 
  pivot_wider(names_from=Response, values_from=n) %>% 
  drop_na(Region) %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=8) %>% 
  colformat_num( na_str = "0" ) %>%
  fix_border_issues %>%
  width( j=2, width=1) %>%
  autofit 

```

### Laboratory tests available 

#### Overall, what arboviral testing capacity(ies) is(are) available in your country? Please check all applicable boxes. (Question 17) 

```{r} 
# fig.height=8}

# relevant question: q17

responses <- get_responses("17")
qdf <- cbind( Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Testing", values_to="Response")
new_cols <- matrix( unlist( strsplit(qdf$Testing, "\\]\\[") ), ncol=2, byrow=T)
qdf <- qdf %>% 
  mutate(Arbovirus = new_cols[,1], Testing = new_cols[,2])
qdf$Response <- as.numeric( qdf$Response)
qdf <- qdf %>% 
  group_by(Region, Arbovirus, Testing) %>% 
  drop_na( Region ) %>% 
  summarize(Total = sum(Response, na.rm=T))
qdf$Arbovirus <- factor( qdf$Arbovirus )
qdf$Testing <- factor( qdf$Testing )

qdf %>% 
  pivot_wider(names_from=Testing, values_from=Total) %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=5*(1:4)) %>% 
  colformat_num( na_str = "0" ) %>%
  fix_border_issues %>%
  autofit 

ggplot(qdf, aes(x=Testing, y=Total, fill=Testing)) + 
  geom_col() + 
  facet_grid( Region ~ Arbovirus ) + 
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill = guide_legend(ncol = 2)) + 
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Testing))))

```

### Serotyping and sequencing capacity? 

(q19)


# Response capacity indicators

### Surveillance and control plans available 

(q 6) Note: question 6 is shown above

### Clinical guidelines for healthcare workers 

(q21)


### Vector control method employed

#### Over the past two years, did your country use any of the following vector control methods in local jurisdictions (either using government staff and resources, or subcontracting to a different entity to do so)? Please select all that apply. (Question 35) 

```{r}

# relevant question: q35

responses <- get_responses("35")
other <- responses %>% select(Other)
responses <- responses %>% select(-Other) 

cbind( Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Method", values_to="Response") %>% 
  group_by(Region, Method, Response) %>% 
  tally %>% 
  pivot_wider(names_from=Response, values_from=n) %>% 
  drop_na(Region) %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=6*(1:4)) %>% 
  colformat_num( na_str = "0" ) 

```


### Surveillance and response committee exists (q47)


### Contingency plan exists (q48)


### Most common vector control methods used 

(q35)


### Indicators used for thresholds 

(q37, 37b, 38)


### Insecticide resistance

(q39)

### Criteria for declaring an outbreak

(q49)


# Epidemiological risk data


### Vectors present and level of risk 

(q34, q34b, q34c)

### Entomological surveillance in the last 2 years

(q28)


### How often is conducted

(q28e)


### Vectors recorded in the last 5 years  and the public health threat 

(q34)
(34b, 34c)


### All arboviruses 2015-2020 (cases and deaths) 

(q55, b, c)


### Most recent year data 

(q56)

