---
title: "Regional data"
---

```{r, include=FALSE, echo = FALSE}
# Basic knitr options
library(knitr)
opts_chunk$set(comment = NA, 
               echo = FALSE,
               warning = FALSE, 
               message = FALSE, 
               error = TRUE, 
               cache = FALSE,
               fig.width = 9.64,
               fig.height = 5.9,
               fig.path = 'figures/')
# options(scipen = '999')
```

```{r, child="_sessioninfo.Rmd"}
```

```{r, echo = FALSE}
source('functions.R')
dict <- load_dict()
df <- load_data()
```

# Surveillance capacity indicators

### Reportable arboviral diseases

#### Question 11  

Is reporting mandatory for any arboviral disease cases in your country? 

```{r}

# relevant question: q11

responses <- get_responses("11")
qdf <- data.frame(Region = df$Region, Response = responses) %>% 
  drop_na(Region) %>% 
  group_by(Region, Response) %>% 
  tally 
tab <- qdf %>% 
  pivot_wider(names_from=Response, values_from=n) %>%
  adorn_totals() 
regulartable( tab ) %>%
  colformat_num( na_str = "-" ) %>%
  hline(i=4) %>%
  autofit 

ggplot( qdf, 
        aes( x = Response,
             y = n,
             fill = Response)) +
  geom_col() +
  facet_wrap( ~Region ) +
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill=guide_legend(ncol=3)) +
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Response)))) +
  labs(title = "Mandatory reporting of cases", 
       y = 'Responses')
  

```

#### Question 11b 

For which of the following arboviral disease cases is reporting mandatory in your country?

```{r}

# relevant question: q11b

responses <- get_responses("11b")
qdf <- cbind(Region = df$Region, responses) %>% 
  pivot_longer(!Region, names_to="Arbovirus", values_to="Response") %>% 
  group_by(Region, Arbovirus, Response) %>% 
  tally
qdf$Response <- str_to_sentence(gsub("Mandatory reporting of ", "", qdf$Response))
tab <- qdf %>% 
  pivot_wider(names_from=Response, values_from=n) %>% 
  drop_na(Region) %>% 
  relocate("Confirmed cases only", .after="All suspect cases") %>%
  rename("No answer"='NA')
tab %>% 
  regulartable %>% 
  merge_v(j = ~Region) %>% 
  valign(j = 1, valign = "top", part = "all") %>% 
  hline(i=6*(1:4)) %>% 
  colformat_num(na_str = "-") %>%
  fix_border_issues() %>%
  width( j=2, width=2 )
  # autofit() 

ggplot(qdf, aes(x=Response, y=n, fill=Response)) + 
  geom_col() + 
  facet_grid( Region ~ Arbovirus ) +
  theme(legend.position = "bottom",
        legend.direction="horizontal",
        axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank()) +
  guides(fill=guide_legend(ncol=4)) +
  scale_fill_manual(name = '',
                    values = make_colors(length(unique(qdf$Response)))) +
  labs(title = "Regional reporting of cases", 
       y = 'Responses')

```

### History of any arbovirus circulation since 2000 

(q5)


### Conducting surveillance on humans

(q12)

### Conducting surveillance on vectors 

(q28) 


### Conducting surveillance on animals 

(q41)

### Training of surveillance personnel and clinicians

(q10) (q24)

### Presence written arbovirus surveillance and control plans

(q6)

### Arbovirus program independent or integrated

(q7)

### Tools for case reporting 

(q9)

# Laboratory diagnostic indicators


### Testing in outbreak vs non-outbreak settings 

(q15)

### Laboratory tests available 

(q17)

### Serotyping and sequencing capacity? 

(q19)


# Response capacity indicators

### Surveillance and control plans available 

(q 6)

### Clinical guidelines for healthcare workers 

(q21)


### Vector control method employed (q35)


### Surveillance and response committee exists (q47)


### Contingency plan exists (q48)


### Most common vector control methods used 

(q35)


### Indicators used for thresholds 

(q37, 37b, 38)


### Insecticide resistance

(q39)

### Criteria for declaring an outbreak

(q49)


# Epidemiological risk data


### Vectors present and level of risk 

(q34, q34b, q34c)

### Entomological surveillance in the last 2 years

(q28)


### How often is conducted

(q28e)


### Vectors recorded in the last 5 years  and the public health threat 

(q34)
(34b, 34c)


### All arboviruses 2015-2020 (cases and deaths) 

(q55, b, c)


### Most recent year data 

(q56)

