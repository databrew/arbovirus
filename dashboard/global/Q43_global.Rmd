
### Community sensitization and participation

#### Community outreach programme existence and scope (ref Q43, 43b, 43c)

```{r}
q43 <- get_responses("43")
q43 <- cbind( Region = data$Region, q43 ) 

nums <- q43 %>% 
  group_by( Region ) %>%
  tally(name = "n_countries")

q43 <- q43 %>%
  group_by(Region) %>%
  filter( Response == "Yes" ) %>% 
  tally(name = "Countries with community outreach programmes for arboviruses")

# q43b <- get_responses("43b") %>%
#   rename( "Entity in charge" = Response)

q43c <- get_responses("43c") 
colnames( q43c ) <- c("Coverage", "Areas") 
q43c$Coverage[ grep("Only selected areas", q43c$Coverage ) ] <- "Limited areas"
q43c <- q43c %>% select( Coverage )
q43c <- cbind( Region = data$Region, q43c ) %>%
  mutate( Countrywide = ifelse( Coverage == "Countrywide", 1, 0 ),
          Limited = ifelse( Coverage == "Limited areas", 1, 0 ) ) %>%
  select( -Coverage ) %>%
  group_by( Region ) %>%
  summarize( across( everything(), ~ sum(.x, na.rm=TRUE))) 

nums %>% 
  left_join( q43, by="Region") %>%
  left_join( q43c, by="Region") %>%
  group_by( Region ) %>%
  mutate( across( everything(), replace_na, 0)) %>% 
  mutate( across( everything(), ~ paste0( .x, " (", round(100*(.x)/n_countries), "%)") ) ) %>%
  select( -n_countries ) %>%
  mutate( Countrywide = paste0("Countrywide: ", Countrywide),
          Limited = paste0("Limited areas: ", Limited)) %>%
  unite( "Coverage", Countrywide:Limited, sep="\n\n" ) %>%
  rename("Regional office" = Region ) %>%
  regulartable() %>% 
  theme_zebra(odd_header="#048ECA", odd_body = "#D6EAF8") %>% 
  color( color="#FFFFFF", part="header" ) %>% 
  align( j=2, align="center", part="all") %>%
  valign( valign = "top", part="header" ) %>%
  padding( padding.top = 10, part="all") %>%
  padding( padding.bottom = 10, part="all") %>%
  width( j = 2, width = 1 ) %>%
  autofit()

```
